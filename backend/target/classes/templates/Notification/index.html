<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
    th:with="pageTitle='Th√¥ng b√°o', content='this :: content'" 
    th:replace="~{layout/base :: layout(~{::content})}">

<body>
    <section th:fragment="content">
        <div class="rounded-2xl border border-neutral-200 bg-white p-6 shadow-sm">
            <div class="flex items-center justify-between mb-4">
                <h1 class="text-lg font-semibold">Th√¥ng b√°o</h1>
                <form th:action="@{/notifications/read-all}" method="post"
                    th:if="${notifications != null and !#lists.isEmpty(notifications)}">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <button type="submit"
                        class="rounded-lg border border-neutral-300 px-3 py-1.5 text-sm hover:bg-neutral-100"
                        data-confirm="ƒê√°nh d·∫•u t·∫•t c·∫£ l√† ƒë√£ ƒë·ªçc?">ƒê√°nh d·∫•u t·∫•t c·∫£ ƒë√£ ƒë·ªçc</button>
                </form>
            </div>

            <div class="divide-y divide-neutral-200"
                th:if="${notifications != null and !#lists.isEmpty(notifications)}">
                <div th:each="n : ${notifications}" class="py-4 -mx-6 px-6 transition"
                    th:classappend="${!n.read}? 'bg-blue-50/50' : ''">
                    <div class="flex items-start justify-between gap-4">
                        <div class="flex items-start gap-3 flex-1">
                            <div
                                class="w-10 h-10 rounded-full bg-gradient-to-br from-neutral-900 to-neutral-600 flex items-center justify-center text-white flex-shrink-0">
                                <span th:if="${n.type.toString() == 'LIKE'}">‚ù§Ô∏è</span>
                                <span th:if="${n.type.toString() == 'COMMENT'}">üí¨</span>
                                <span th:if="${n.type.toString() == 'FRIEND_REQUEST'}">üë•</span>
                                <span th:if="${n.type.toString() == 'MESSAGE'}">‚úâÔ∏è</span>
                                <span th:if="${n.type.toString() == 'SYSTEM'}">üîî</span>
                            </div>
                            <div class="flex-1">
                                <div class="text-sm" th:text="${n.message}">N·ªôi dung th√¥ng b√°o</div>
                                <div class="text-xs text-neutral-500 mt-1"
                                    th:text="${#temporals.format(n.createdAt,'dd/MM/yyyy HH:mm')}">time</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            <form th:if="${!n.read}" th:action="@{|/notifications/${n.id}/read|}" method="post">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                                <button type="submit"
                                    class="rounded-lg border border-neutral-300 px-3 py-1.5 text-sm hover:bg-neutral-100 whitespace-nowrap">
                                    ƒê√°nh d·∫•u ƒë√£ ƒë·ªçc
                                </button>
                            </form>
                            <form th:action="@{|/notifications/${n.id}/delete|}" method="post">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                                <button type="submit"
                                    class="rounded-lg border border-red-300 text-red-600 px-3 py-1.5 text-sm hover:bg-red-50"
                                    data-confirm="Xo√° th√¥ng b√°o n√†y?">Xo√°</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div th:if="${notifications == null or #lists.isEmpty(notifications)}"
                class="text-center text-neutral-500 py-16">
                <div class="text-4xl mb-2">üîî</div>
                <p>Kh√¥ng c√≥ th√¥ng b√°o n√†o.</p>
            </div>
        </div>
    </section>
</body>

</html>
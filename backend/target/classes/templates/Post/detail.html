<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/userbase :: layout(~{::content})}">

<body>
    <section th:fragment="content">

        <article class="max-w-2xl mx-auto bg-white border border-neutral-200 rounded-2xl p-6 shadow-sm">

            <!-- HEADER -->
            <header class="flex items-center gap-3 mb-4">

                <!-- Avatar -->
                <div class="h-10 w-10 rounded-full overflow-hidden bg-neutral-200">
                    <img th:if="${post.author.avatarUrl != null}" th:src="${post.author.avatarUrl}"
                        class="w-full h-full object-cover" />

                    <div th:if="${post.author.avatarUrl == null}" class="w-full h-full bg-neutral-300"></div>
                </div>

                <!-- Username + time -->
                <div>
                    <p class="text-sm font-semibold" th:text="${post.author.username}">username</p>
                    <p class="text-xs text-neutral-500"
                        th:text="${#temporals.format(post.createdAt,'dd/MM/yyyy HH:mm')}">
                    </p>
                </div>

            </header>

            <!-- CONTENT -->
            <p class="text-sm mb-3" th:text="${post.content}"></p>

            <!-- IMAGES WITH SMART GRID -->
            <div th:if="${post.images != null and !#lists.isEmpty(post.images)}"
                th:switch="${#lists.size(post.images)}">

                <!-- 1 ảnh -->
                <div th:case="1" class="grid grid-cols-1 gap-2">
                    <img th:src="${post.images[0].imageUrl}" class="w-full object-cover rounded-xl max-h-[500px]" />
                </div>

                <!-- 2 ảnh -->
                <div th:case="2" class="grid grid-cols-2 gap-2">
                    <div th:each="img : ${post.images}">
                        <img th:src="@{'/uploads/' + ${img.imageUrl}}" class="w-full h-72 object-cover rounded-xl" />
                    </div>
                </div>

                <!-- 3 ảnh (layout Facebook) -->
                <div th:case="3" class="grid grid-cols-2 grid-rows-2 gap-2">
                    <div th:each="img, i : ${post.images}">
                        <img th:src="@{'/uploads/' + ${img.imageUrl}}" th:classappend="${i.index == 0} ? 'row-span-2 h-full' : ''"
                            class="w-full object-cover rounded-xl h-72" />
                    </div>
                </div>

                <!-- 4+ ảnh -->
                <div th:case="*" class="grid grid-cols-3 gap-2">
                    <div th:each="img : ${post.images}">
                        <img th:src="@{'/uploads/' + ${img.imageUrl}}" class="w-full h-60 object-cover rounded-xl" />
                    </div>
                </div>

            </div>

            <!-- Footer -->
            <footer class="text-xs text-neutral-500 mt-3">
                <span th:text="${post.likeCount} + ' lượt thích'"></span> ·
                <span th:text="${post.commentCount} + ' bình luận'"></span>
            </footer>

        </article>

    </section>
</body>

</html>